% !TeX root = RJwrapper.tex
\title{A clustering algorithm to organize satellite hotspots data for the
purpose of tracking bushfires remotely}
\author{by Weihao Li, Emily Dodwell, Dianne Cook}

\maketitle

\abstract{%
An abstract of less than 150 words.
}

\hypertarget{introduction}{%
\subsection{Introduction}\label{introduction}}

Bushfires are a major problem for Australia, and many other parts of the
globe. There is concern that as the climate becomes hotter, and drier,
that the impact of fires becomes much more severe and extensive. In
Australia, the 2019-2020 fires were the worst on record causing
extensive ecological damage, as well as damage to agricultural
resources, properties and infrastructure. The Wollemi pine, rare
prehistoric trees, required special forces intervention to prevent the
last stands in the world, in remote wilderness areas, from being turned
into ash.

Contributing to the problem is that many fires started in very remote
areas, locations deep into the temperate forests ignited by lightning,
that are virtually impossible to access or to monitor. Satellite data
provides a possible solution to this, particularly remotely sensed hot
spot data, which may be useful in detecting new ignitions and movements
of fires. Understanding fires in remote areas using satellite data may
provide some help in developing effective strategies for mitigating
bushfire impact.

This work addresses this topic. Using hot spot data, can we cluster in
space and time, in order to determine (1) points of ignition and (2)
track the movement of bush fires.

This paper is organised as follows. The next section provides an
introduction to the literature on spatiotemporal clustering and bush
fire modeling and dynamics. Section \citet{algorithm} describes the
clustering algorithm, and section \citet{application} illustrates how
the resulting data can be used to study bush fire ignition.

\hypertarget{background}{%
\subsection{Background}\label{background}}

\hypertarget{spatiotemporal-clustering}{%
\subsubsection{Spatiotemporal
clustering}\label{spatiotemporal-clustering}}

\hypertarget{bushfire-modeling}{%
\subsubsection{Bushfire modeling}\label{bushfire-modeling}}

\hypertarget{algorithm}{%
\subsection{Algorithm}\label{algorithm}}

\hypertarget{data-pre-processing}{%
\subsubsection{Data pre-processing}\label{data-pre-processing}}

To track bushfires in Australia remotely, we used hotspots data taken
from the Himawari-8 satellite. The hotspots data is available on the
JAXA FTP site in CSV file format, and only the data during October 2019
to March 2020 was downloaded. It contains records of 1989572 hotspots
for 5 months in the full disk of 140 \textdegree east longitude. We only
kept records of hostpots within the boundary of Australia, which reduced
to 1526080 records. Besides, a threshold (irradiance over 100 watts per
square metre) for fire power was used to filter hotspots data, which can
limit the influence of radiation from other objects. For the convention
of this algorithm, a sequence of discrete timestamps was needed. We
calculated the hourly difference between each record and the earliest
record, then rounded them to integers. The end result was a 1010794
\(\times\) 4 dataset. The four fields were the unique identifier for
each row, the longitude, the latitude and the indicator of timestamps
respectively. The code to implement this process is in ``main.R''. Read
in CSV files was done by using package \texttt{readr}. Data manipulation
was done by using package \texttt{dplyr}. High resolution Australia
vector map was obtained from package \texttt{rnaturalearth}. Operation
of geometric intersection between hotspots and Australia map was done by
using package \texttt{sf}.

\begin{Schunk}
\begin{figure}
\includegraphics[width=0.8\linewidth]{clustering_paper_files/figure-latex/hotspots-1} \caption[Hotspot locations in Victoria during2019-2020 season]{Hotspot locations in Victoria during2019-2020 season.}\label{fig:hotspots}
\end{figure}
\end{Schunk}

\hypertarget{steps}{%
\subsubsection{Steps}\label{steps}}

After the data pre-processing, this algorithm ran in a time-series
manner. It first selected entries of the first timestamps, which was the
first hour in the hotspots data. The algorithm then calculated the
matrix of pairwise geodesic distances between all points being selected.
With the geodesic distances matrix, an ``adjacent distance'' as one of
the hyperparameters in this algorithm was used to determine the
adjacency matrix. If a geodesic distance between two points was less
than the ``adjacent distance'', the corresponding entry in the adjacency
matrix would be assigned with integer 1, otherwise it would be assigned
with integer 0. Normally, this ``adjacent distance'' would be set
between 0 to 100000 meters. Using the adjacency matrix, the algorithm
then constructed a undirected unweighted graph. For each connected
component in this graph, a unique integer was assigned as the
membership. In our hotspots data, components could be recognised as
bushfires. Points in the same component shared with the same membership.
Meanwhile, the longitude and the latitude of centroids in each component
were calculated by taking the average of longitude and the average of
latitude for all points in the corresponding component. Those centroids
along with memberships would then be recorded and labelled as active
groups. In other words, their ``active'' attributes were assigned with
integer 0.

When the algorithm moved to the next timestamps, it subtracted 1 from
``active'' attributes. Another hyperparameter ``group active time'' was
used for selecting active groups. Conventionally, ``group active time''
was set to be 24 hours. If any centroid had an ``active'' attribute
greater than the negative of ``group active time'', it would be selected
as active groups.

For the second and the later timestamps, the algorithm first combined
centroids of active groups with the hotspots data in the corresponding
timestamps. It then calculated geodesic distances matrix, filled
adjacency matrix and constructed graph as before. There was an
additional step which was to find the nearest active group within the
same component for each point. If a point shared the same component with
active groups, it would be assigned with the membership of the nearest
active group. Otherwise, points shared with the same component would be
assigned with a new membership. Therefore, points in one component would
not necessary had the same membership if there were more than one active
groups within a component. All centroids of active groups and new group
would then be recalculated and updated using only the current timestamps
hotspots data. Their ``active'' attributes were set to be 0.

This algorithm worked till the last timestamps. The end result was a
vector of memberships with length equal to number of rows in hotspots
data and a time-series record of all groups.

For computational performance, we stored the hostpots data in a SQLite
database. Relevant operation was done by using packages \texttt{DBI} and
\texttt{RSQLite}. Geodesic distances matrix was calculated using package
\texttt{geodist}. Graph operation was done by using package
\texttt{igraph}.

The code implemented this algorithm is ``clustering.R''.

(Code in clustering.R does this, needs cleaning up)

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Divide hotspots by hour
\item
  Start from the first hour
\item
  Connect adjacent hotspots and active centroids (3km)
\item
  For each point, if there is a connected nearest active centroid, join
  its group
\item
  Otherwise, create a new group for each connected graph
\item
  Compute centroid for each group
\item
  Keep the group active until there is no new hotspots join the group
  within 24 hours
\item
  Repeat this process to the last hour
\end{enumerate}

\begin{Schunk}
\begin{figure}
\includegraphics[width=1\linewidth]{clustering_paper_files/figure-latex/clusters-1} \caption[Main clusters in one area over time]{Main clusters in one area over time.}\label{fig:clusters}
\end{figure}
\end{Schunk}

\hypertarget{effects-of-parameter-choices}{%
\subsubsection{Effects of parameter
choices}\label{effects-of-parameter-choices}}

\hypertarget{using-the-resulting-data}{%
\subsection{Using the resulting data}\label{using-the-resulting-data}}

\hypertarget{determining-the-ignition-point-and-time-for-individual-fires}{%
\subsubsection{Determining the ignition point and time for individual
fires}\label{determining-the-ignition-point-and-time-for-individual-fires}}

\hypertarget{tracking-fire-movement}{%
\subsubsection{Tracking fire movement}\label{tracking-fire-movement}}

\hypertarget{allocating-resources-for-future-fire-prevention}{%
\subsubsection{Allocating resources for future fire
prevention}\label{allocating-resources-for-future-fire-prevention}}

Merging data with camp sites, CFA, roads, \ldots{}

\hypertarget{summary}{%
\subsection{Summary}\label{summary}}

\hypertarget{acknowledgements}{%
\subsection{Acknowledgements}\label{acknowledgements}}

\begin{itemize}
\tightlist
\item
  The code and files to reproduce this work are at XXX
\item
  Data on hotspots can be downloaded from XXX
\end{itemize}

\bibliography{RJreferences}


\address{%
Weihao Li\\
Monash University\\
line 1\\ line 2\\
}
\href{mailto:wlii0039@student.monash.edu}{\nolinkurl{wlii0039@student.monash.edu}}

\address{%
Emily Dodwell\\
AT\&T\\
line 1\\ line 2\\
}
\href{mailto:emily@research.att.com}{\nolinkurl{emily@research.att.com}}

\address{%
Dianne Cook\\
Monash University\\
line 1\\ line 2\\
}
\href{mailto:dicook@monash.edu}{\nolinkurl{dicook@monash.edu}}

