---
title: "Using Remote Sensing Data to Understand Fire Ignition During the 2019-2020 Australia Bushfire Season"
author:
- familyname: Li
  othernames: Weihao
  address: Monash University
  email: wlii0039@student.monash.edu
  correspondingauthor: true
  qualifications: EBS Honours student
department: Department of\newline Econometrics &\newline Business Statistics
organization: for Honours, supervised by Prof. Di Cook
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  MonashEBSTemplates::researchplan:
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, cache=TRUE, messages=FALSE, warning=FALSE)
# Make sure you have the latest versions of rmarkdown and bookdown installed
library(ggplot2)
library(tidyverse)
library(kableExtra)
```


# Introduction

In Australia, bushfires have historically caused massive loss of property and life. Since the 1967 Hobart bushfires, the insurance claims for building losses was greater than $A10 million (McAneney, Chen & Pitman, 2009). <!-- McAneney, Chen and Pitman (2009) show in their research that the average number of buildings had been destroyed by bushfire per year is 84, accounting for 20% of total building losses in hazard events.-->


The Australian bushfire season in 2019-2020, compared with other major bushfires in history, had a more devastating impact on the environment and properties.  According to the Parliament of Australia report (2020) in this past bushfire season, 3094 houses have been destroyed and over 17M hectares of land burned. These two figures are the highest in history. Fortunately, only 33 people including firefighters died compared to 173 in the Black Saturday fires and 47 in Ash Wednesday fires (Parliament of Australia, 2020).

Understanding the cause of the 2019-2020 Australian bushfires is a crucial step to provide information for future policy and fire risk management.

The research is also motivated by the lack of knowledge about the cause of bushfire in Australia. Beale and Jones (2009) state in their research that the cause is only known for 58.9% of fires. Historically, about 50% are due to deliberate and suspicious ignitions, 35% by accidents and 6% natural, such as lightning. Providing a probable cause for bushfires may help investigators in practice.

# Research aims and	questions

Australia 2019-2020 experience one of the most devastating bushfire seasons in history. How these fires started it's an important question in order to manage future hazard events. Lightning strikes and arson were been discussed publicly. This research will explore the potential methods of fire ignition during 2019-2020 Australia bushfires season based on the new availability of satellite data and provide a model to predict the fire risk of neighbourhoods. Hotspots data from the JAXA’s Himawari-8 satellite and weather data from the Australian Bureau of Meteorology will be used in ignition identification and bushfire danger estimation. 

The aim of this research is to predict the ignition method of the 2019-2020 bushfires. More specifically, the work will answer these research questions:

  1. Using satellite hotspots data can we detect ignition time and location? 
  2. Can data from other sources including vegetation, weather, proximity to road and recreation site help to inform ignition type?
  3. How do the characteristics of 2019-2020 bushfires compare to historical bushfires?
  4. Can we make a useful model for the fire risk across Australia? What predictors including fire indexes, proximity to road and recreation site, weather and vegetation are useful for modelling fire risk? 


# Review of literature

Existing researches in bushfires modelling can be divided into two main categories, one is simulation modelling, another is analytical modelling. 

In simulation modelling, Keane et al. (2004) have attempted to use landscape fire succession models (LFSMs) to model fire behaviour including fire ignition and fire spread. They are a group of spatial simulation models which taking into account fire and vegetation dynamics. Similarly, Bradstock et al. (2012) used FIRESCAPE model which mainly involved simulating fire behaviours with fuel and weather conditions. Simulation methods are cost-effective and time-effective in modelling bushfires (Clarke et al., 2019). However, Clarke et al. (2019) also stated in their research that ignition likelihood is not well discussed and considered in these models. Besides, these methods seldomly address ignition types of bushfires which we are interested in. Therefore, simulation modelling will not be considered in our bushfire ignition research. 

Alternatively, analytical modelling is a more popular way to build bushfires models. In analytical modelling, the general framework for analysing bushfires ignitions is generalised additive model (GAM). Bates, McCaw and Dowdy (2018) used it for predicting the number of lightning ignitions. Some studies include a logit link to extend the model for bushfires ignition likelihood prediction (Read, Duff and Taylor, 2018; Zhang, Lim and Sharples, 2017). Mixed-effects had also been considered for incorporating spatial and weather factors (Duff, Cawson and Harris, 2018). Simpler models were been used in this field, like multiple linear regression, negative binomial regression and generalised logistic regression (Cheney, Gould, McCaw and Anderson, 2012; Plucinski, McCaw, Gould and Wotton, 2014; Collins, Price and Penman, 2015). Particularly, instead of using a model, some researches performed statistical testing and exploratory data analysis to test certain hypothesises of bushfires (Miller et al., 2017; Dowdy, Fromm and McCarthy, 2017).

Common covariates for ignitions analysis are weather conditions, vegetation types, topographic information and anthropogenic variables. In addition, various indexes had been used in modelling. Some studies choose to use index variables developed by McArthur such as Forest Fire Danger Index (Clarke et al., 2019; Read et al., 2018), while others choose to use indexes developed by Canadian Forestry Service such as Canadian Fire Weather Index and Drought Code (Plucinski et al., 2014). We doubt that these indexes are irrelevant with fire ignition prediction because they are extracted from weather and vegetation information. However, it may help improve our model performance because it can be viewed as features generated from feature engineering. We will test if index variables are significant in our research.

Although numerous studies for ignitions analysis have applied semiparametric and parametric methods, little analytics attention has been paid to more complex models like the tree-based model, support vector machine and artificial neural network. These tools are well developed in machine learning, which will be considered in this research.

Most of the existing works of bushfire ignition analysis focus on a certain area such as south-eastern Australia (Clarke et al., 2019), or a certain state such as Victoria (Read, Duff & Taylor, 2018). Little of existing works have applied prediction across Australia.

# Project	design

## Data collection

There are numerous open-source data sets available that are collated to provide the data to address the research questions. The main data resource that differs from that used in the literature is the satellite data that records hotspots. The next sections describe how the data is accessed, and pre-processed for later analysis. 


### Sources

Table \ref{tab:datasetinfo} summarises the data sources.


### Hotspots

Hotspot data is downloaded from the JAXA’s Himawari-8 satellite. This satellite is positioned in geostationary orbit at 140 degrees east longitude, and the revisit period is 10-minute. Its management system - JAXA's P-Tree system, provides WildFire observation product with 2km spatial resolution. (P-Tree System, 2020). Details on how to download this data are provided by [ozjim post]. 

### Weather

Weather data were collected from the Australian Bureau of Meteorology, by using an R package - Bomrang (Adam, Mark, Hugh & Keith, 2020). Due to the limitation of APIs provided by the package, we crawled data from BOM's website for extra information. 


### Fuel layer

To characterise the fuel we used forest of Australia (2018) from the Australian Bureau of Agriculture and Resource Economics and Sciences. It is a fuel layer contains the vegetation information across Australia.


### Fire origins

Fire origins are the existing records of historical bushfires ignition which is downloaded from the Department of Environment, Land, Water Planning. This dataset is used to understand the characteristic of each type of ignition.  It helps us to identify the causes of 2019-2020 bushfires.

## Data preprocessing

### Data types

The hotspot and weather data is in CSV format, which can be processed generally with the `tidyverse` tools (Wickham et al., 2020) in R. Fuel layer and other map data are presented as geospatial objects, which can be processed using the tools in the `sf` (Pebesma, 2020). 

### hotspots clustering

Hotpots are point data obtained by light detection from the satellite. They are snapshots of bushfires every 10 minutes. However, just like it is hard to identify a single plant from the top view of a grassland, information about individual bushfire can not be directly derived from the raw hotspot data. In order to understand the ignition time and ignition place of each bushfire, we need to divide hotspots into clusters and trace the growth of each cluster. 

To preprocess the hotspots data, we selected the observations in Australia from the full disk. Meanwhile, hotspots with irradiance under 100 watt per square metre will be deleted. We restricted our study to hotspots that have significant firepower. An hour id has been assigned to each observation range from 1 to T, represents the relative time the hotspot being observed.

On top of the tidy hotspots data, a clustering algorithm was developed to identify fire clusters. Details about the algorithm can be found in table \ref{tab:clustering}. 

By using this algorithm, we assigned each hotspot a cluster membership which we called *fire_id*. Meanwhile, we recorded the characteristics of each cluster including its centroid, starting time, ending time and movement. The inspiration behind this algorithm is the behaviour of real-world bushfire which can be summarised as two hyperparameters, the distance of spread in each hour and the lifetime of fire since last observed, represented by $r_0$ and $t_0$ respectively. These two hyperparameters have been used to determine if a new hotspot belongs to an existing or new cluster.

Figure \ref{fig:mov} shows


### Compiled data

The end result of the data pre-processing is a set of data tables, that are uniquely identified by individual primary key and related by a set of foreign keys.  Figure \ref{fig:ERD} shows these tables and the key which allow information to be compared across tables. Technically, this figure is called a conceptual entity relationship diagram. It will be useful for describing the data model to be used in both modelling and web interface for communicating fire risk.

## Exploratory data analysis

### Overview of 2019-2020 Australia bushfire season

Figure \ref{fig:overview} sfsdfs

## Modelling

In this research, two types of models will be developed and tested. One is the ignition method prediction model, which is used for analysing ignition type of 2019-2020 bushfires and predicting the causes of future bushfires. Another is the fire risk model. It will learn the features of hotspots and predict the probability of hotspots occurrence. The following sections will discuss the plan to develop these two models.

## Predicting ignition method

To analysis and predict the ignition method of bushfires, historical causes of bushfires will be used as training data. The modelling problem will be a multiclass classification problem. Incorporating vegetation, topographic and climate information as independent variables, a group of models will be tested. These include parametric models like the generalized linear model, semiparametric models like the generalized additive model and nonparametric models like random forest, support vector machine and artificial neural network. 

## Modelling fire risk

The framework of fire risk modelling is similar to ignition method prediction. It will be a binary classification problem. The aim of this model is to predict the probability of bushfire ignition in a cell of the grid. The grid will be designed to fit the shape of Victoria with spatial resolution equal to 50km. The training data will be the hotspots data instead of bushfires history. Potential models will be the same as ignition method prediction.

# Timeline

The research plan for this semseter can be found in Table \ref{tab:timeline1}. Future research plan can be found in Table \ref{tab:timeline2}.


# Expected outcomes

In addition, an interactive web application embeds with research outcomes will be built for data visualization purpose.

\newpage


# Appendix A {-}

```{r datasets, results='asis'}
datasets_info = data.frame(name = c("Hotspots data - JAXA’s Himawari-8 satellite",
                                    "Weather data - Australian Bureau of Meteorology",
                                    "Map - OpenStreetMap",
                                    "Fuel layer - Australian Bureau of Agriculture \\\\ $\\hspace{5mm}$ and Resource Economics and Sciences",
                                    "Victorian CFA fire stations - Department of Environment, \\\\ $\\hspace{5mm}$Land, Water $\\&$ Planning",
                                    "Victorian Recreation sites - Department of Environment, \\\\ $\\hspace{5mm}$Land, Water $\\&$ Planning",
                                    "Fire Origins - Department of Environment, \\\\ $\\hspace{5mm}$Land, Water $\\&$ Planning"), 
                           spatialresolution = c("$0.02^\\circ \\approx 2km$",
                                                 "",
                                                 "2m",
                                                 "100m",
                                                 "20m",
                                                 "10m",
                                                 "100m"), 
                           temporalresolution = c("Per 10 minutes",
                                                  "Daily",
                                                  "",
                                                  "",
                                                  "",
                                                  "",
                                                  ""),
                           time = c("2015-2020",
                                    "2019-2020",
                                    "2020",
                                    "2018",
                                    "2020",
                                    "2020",
                                    "1972-2019"))

knitr::kable(datasets_info, 'latex', 
             caption  = 'Data information', 
             label = "datasetinfo",
             booktabs = TRUE,
             col.names = c("Data set name", "Spatial Resolution", "Temporal resolution", "Time"),
             escape = FALSE) %>%
  kable_styling(font_size = 9)

```

![The movement path and hotspots map shows the bushfire behaviour of bushfire "454" and bushfire "1420", which is two clusters from the results of clustering algorithm. The triangle is the ignition point of bushfire and the rectangle is the extinguish point. The black line is the movement of bushfire centeroid. points with red color and larger size are hotspots with higher firepower which is measured by watt per square metre. We can know that bushfires ignited with low firepower, and will getting hotter when time pass, then finally extinguish with not enough fuel. \label{fig:mov}](figures/fire_mov.jpg){width=500px}

\normalfont
\begin{table}
\caption{\label{tab:clustering}A clustering algorithm for hotspots}
\begin{align*}
&\rule{150mm}{0.5mm}\\[-1\jot]
&\textbf{Algorithm 1 Hotspots clutering}\\[-1\jot]
&\rule{150mm}{0.5mm}\\[-1\jot]
&\textbf{input: }~~~~\text{Hotspots dataset H : (Hour}\textunderscore \text{id}^{(n)} \text{, Coordinates}^{(n)} \text{), n = 1, 2, ... N}\\[-1\jot]
&~~~~~~~~~~~~~~~~\text{An empty dataset F : (Fire\textunderscore id}^{(m)} \text{, Coordinates}^{(m)} \text{, Active}^{(m)} \text{), m = 1, 2, ...}\\[-1\jot]
&~~~~~~~~~~~~~~~~\text{An empty vector K} \in \mathbb{N}_1^n\\[-1\jot]
&~~~~~~~~~~~~~~~~\text{A distance hyperparameter }r_0 \in \mathbb{R}^+\\[-1\jot]
&~~~~~~~~~~~~~~~~\text{A time hyperparameter }t_0 \in \mathbb{N}^+\\[-1\jot]
&\textbf{output: }~~\text{A vector K} \in \mathbb{N}_1^n~\text{contains memberships of hotspots}\\[-1\jot]
&~~~~~~~~~~~~~~~~\text{A dataset F contains fire clusters information including memberships, latest}\\[-1\jot]
&~~~~~~~~~~~~~~~~\text{centroids and time from last updated}\\[-1\jot]
&~~1:~~\text{select subset }H_c \in \text{H where Hour\textunderscore id == 1}\\[-1\jot]
&~~2:~~\text{calculate distance matrix D for Coordinates in }H_c \\[-1\jot]
&~~3:~~\text{assign 1 to a zero adjacency matrix A for where D} \leq r_0~~//~~\text{hotspots with relative}\\[-1\jot]
&~~~~~~~~~\text{distance less or equal to }r_0~\text{will be considered belong to the same cluster} \\[-1\jot]
&~~4:~~\text{create undirected unweighted graph G from A}\\[-1\jot]
&~~5:~~\text{record memberships of G to K}\\[-1\jot]
&~~6:~~\text{record clusters classes to Fire\textunderscore id and record clusters centroids to Coordinates of F}\\[-1\jot]
&~~7:~~\text{set Active in F to }t_0~~//~~\text{Active clusters are fire being observed in the last }t_0~\text{hour}\\[-1\jot]
&~~8:~~\textbf{for}~~\text{hour = 2, ... T}~~\textbf{do} \\[-1\jot]
&~~9:~~~~~~~~\text{let Active -1 and select subset }F_c \in \text{F where Active} \geq 0\\[-1\jot]
&10:~~~~~~~~\text{select subset }H_c \in \text{H where Hour\textunderscore id == hour}\\[-1\jot]
&11:~~~~~~~~\text{append Coordinates from }F_c~\text{to}~H_c\\[-1\jot]
&12:~~~~~~~~\text{repeat step 2 - 4}\\[-1\jot]
&12:~~~~~~~~\textbf{for}~~h_i = \text{each hotspot in }H_c~~\textbf{do}\\[-1\jot]
&13:~~~~~~~~~~~~~~\textbf{if}~~h_i~\text{share the same membership as one of active clusers in }F_c~~\textbf{then}\\[-1\jot]
&14:~~~~~~~~~~~~~~~~~~~~\text{copy the corresponding Fire\textunderscore id of the nearest active cluser to K}\\[-1\jot]
&15:~~~~~~~~~~~~~~\textbf{else}~~\text{copy the membership from G to K}\\[-1\jot]
&16:~~~~~~~~~~~~~~\textbf{end if}\\[-1\jot]
&17:~~~~~~~~\textbf{end for}\\[-1\jot]
&18:~~~~~~~~\text{update F for clusters involed in current timestamp and reset corresponding}\\[-1\jot]
&~~~~~~~~~~~~~~~\text{Active to }t_0\\[-1\jot]
&19:~~\textbf{end for}\\[-1\jot]
&\rule{150mm}{0.5mm}
\end{align*}
\end{table}

![Entity relationship diagram illustrating the relational tables of the compiled data. Tables correspond to processed hotspot data, weather, local facilities like CFA sites. This data structure is useful for the data modeling and web app development.  \label{fig:ERD}](figures/Shiny_app_data_Conceptual_ERD.jpeg)

![The grid map illustrating the general situation of Victoria during 2019-2020 Australia bushfire season. The severest time for Victoria was December when the massive amount of bushfires ignited in Eastern Victoria. Places like East Gippsland suffered from this devastating crisis. \label{fig:overview}](figures/number_of_ignitions.jpg){width=500px}


```{r timeline, results='asis'}
timeline = data.frame(Timeline = c("Week 2","Week 3","", "Week 4","", "Week 5", "Week 6", "Week 7","Week 8", "week 9"),
                      Tasks = c("Geographic data background reading",
                                "Collect Remote sensing data (JAXA himawari-8 satellite) and",
                                "explore BOM weather data APIs (Bomrang)",
                                "Collect Road Map (OpenStreetMap) and",
                                "read articles in SpatioTemporal data visualization and modelling",
                                "Develop clustering algorithm for remote sensing data",
                                "Test diferent hyperparameters for clusetring",
                                "Exploratory data analysis on fire clusters and data integration",
                                "Feature planning for the shiny app",
                                "Write research proposal and prepare the first presentation"))


knitr::kable(timeline, "latex",
             caption = "Research plan till week 9",
             label = "timeline1",
             booktabs = TRUE,
             escape = FALSE) %>%
  kable_styling(latex_options = "hold_position")
  
```

```{r}
timeline = data.frame(Timeline = c("June - July", "August", "September", "October"),
                      Tasks = c("Modelling fire ignition and fire risk", "Consolidate findings and create mockups of the shiny app", "Develop the shiny app and perform different levels of testing", "Write thesis and prepare the second presentation")) 

knitr::kable(timeline, "latex",
             caption = "Research plan since June",
             label = "timeline2",
             booktabs = TRUE,
             escape = FALSE) %>%
  kable_styling(latex_options = "hold_position")
```
