---
chapter: 7
knit: "bookdown::render_book"
---

# Discussion {#ch:discussion}

## Policy Implications

Our prediction suggests that the main cause of the 2019-2020 Australia bushfires was lightning. And according to the clustering results, these fires were mostly started in remote areas, like East Gippsland. We suggest the Forest Fire Management Victoria and the Country Fire Authority to consider delivering planned burns on a larger scale in these regions in an earlier date ahead of the bushfire season. Smoke and pollution to the environment produced by the planned burns are unavoidable, but it is considerably better than the uncontrollable bushfires. We need to choose between them. Meanwhile, modern technology for monitoring and fighting bushfires like satellite sensors, community sensors and drones could be deployed in these areas to overcome the difficulties of reaching the ignition point. Budgets on bushfire prevention need to increase if possible, or at least, distribute heavier to these areas to employ more firefighters during the bushfire season. 

Besides, according to our prediction, the number of accident-caused bushfires rose significantly in March 2020. We suspect they are correlated to certain types of human activities or weather conditions. Bushfire investigators in Country Fire Authority may need to reveal the motivations behind this phenomenon to reduce this controllable impact on bushfire ignition.


Finally, future bushfire investigation could be performed more concisely by utilising satellite hotspots data and modern machine learning framework. We have shown this is achievable and we suggest the government could spend some resources on developing a set of reliable and accurate models to predict the causes of the bushfire remotely by fusing the available data, the research of climate scientists and the experience of investigators. This could overcome the workforce shortage and reduce the countless time spent on the investigation.

 

## Limitation

### Data source

In this research, we didn't take into account the vegetation dynamics in modelling, instead, we only used a static map of vegetation information. This could lead to ineffective use of vegetation factors. However, we didn’t find a similar public vegetation dataset in previous years. This could be mitigated in the future when there are more available data. Moreover, in the prediction, we used the ASOS wind speed as covariates. ASOS network only has a few stations near Melbourne so our weather conditions could be inaccurate. We knew there were accurate wind speed data on BOM, but they were not free to the public.

### Clustering algorithm

Our clustering algorithm used only satellite hotspots data to reconstruct the bushfire dynamics. This didn’t incorporate the vegetation factors, slope, smoke and weather conditions, which might affect the speed of the fire, the direction of the fire and the tolerance of the missing observations. This was already out of the scope of this research since it would take more time and effort but we already spent months to develop the current version.

### Modelling

There were other machine learning models we didn’t test on this task, like artificial neural network which might boost the performance. However, complex machine learning model needed great effort in hyperparameters tuning which was possibly infeasible for our computing platform.

There were also other machine learning modelling techniques we didn’t use in this research. The most impactful two would be feature engineering and ensemble modelling. We believed these methods could potentially increase our model performance, but we didn’t apply them due to the time constraint. We might consider trying them in future work.

## Future work

Our model can produce the probability of the bushfire ignited by a certain type of sources, but it doesn't provide us with the general risk of the bushfire ignited by that cause. Using the lightning-ignited bushfire as an example, it will give us

$$P(L|S,\mathcal{F})$$
where $L = the~bushfire~ignited~by~lightning$, $S = the~bushfire~ignited$ and $\mathcal{F}$ is other information of the ignition, such as location, time, weather conditions, etc.

This probability is useful for bushfire investigation but is not particularly helpful for bushfire risk prediction. In general, decision makers wants to know the risk of the lightning-ignited bushfire $P(L,S|\mathcal{F})$ or the probability of the overall bushfirefire risk given certain conditions $P(S|\mathcal{F})$.

Our work can be extended by using the decomposition of the conditional probability:

$$P(L,S|\mathcal{F}) = P(L|S,\mathcal{F})P(S|\mathcal{F})$$

We will demonstrate how this works by using the a naive method to estimate the $P(S|\mathcal{F})$ and eventually yield the $P(L,S|\mathcal{F})$.

A reasonable estimate of the probability of the bushfire starts in a region in a certain month is the fraction of the number of past December we observed bushfires on the total number of past December. Figure \ref{fig:mcsim} is the estimate of $P(S|\mathcal{F})$. As you can see, it produces a lot of missing values because we didn't observe bushfires in those regions in the past. The joint probability $P(L,S|\mathcal{F})$ can then be calculated by omitting other factors and simply using the prediction of 2019-2020 Australia bushfires. Figure \ref{fig:posterior} shows the final product. It can be directly used as the prediction of the risk of lightning-ignited bushfire.

Therefore, the potential future work will be developing a model to predict the overall risk $P(S|\mathcal{F})$ such that we can obtain the prediction of the risk of bushfire ignited by different causes.

```{r mcsim, fig.cap="A map of the frequency of bushfire occurred in a region. Some regions contain missing values because there was no observed bushfire."}
 set.seed(10086)
  
  # Read in training data
  training <- read_csv("data/training.csv")
  
  training <- training %>%
    filter(!CAUSE %in% c("BURNING BUILDING",
                         "WASTE DISPOSAL, INDUSTRIAL, SAWMILL, TIP",
                         "WASTE DISPOSAL, DOMESTIC",
                         "BURNING VEHICLE, MACHINE",
                         "BURNING BUILDING")) %>%
    filter(new_cause != "other") %>%
    filter(new_cause != "relight")
  
  
  training <- select(training, -c(EVENTID:FIRE_NUM), -id, -CAUSE, -FOREST, -FOR_CODE, -FOR_CAT)
  
  training <- mutate(training,
                     year = factor(year(FIRE_START)),
                     month = factor(month(FIRE_START), levels = c(10,11,12,1,2,3)),
                     day = factor(day(FIRE_START), levels = c(1:31)),
                     wod = factor(wday(FIRE_START), levels = c(1:7)))
  
  training <- filter(training, month %in% c(10,11,12,1,2,3))
  
  training <- na.omit(training)
  
  training <- mutate(training, new_cause = ifelse(new_cause == "accidental_human", "accident", new_cause)) %>%
    mutate(new_cause = ifelse(new_cause == "burning_off_human", "burning_off", new_cause)) %>%
    mutate(new_cause = factor(new_cause)) %>%
    mutate(FOR_TYPE = factor(FOR_TYPE))
  
  training <- na.omit(training)
  
  training <- mutate(training,
                     log_dist_cfa = log(dist_cfa),
                     log_dist_camp = log(dist_camp),
                     log_dist_road = log(dist_road),
                     COVER = factor(COVER),
                     HEIGHT = factor(HEIGHT))
  
  training <- rename(training, cause = new_cause)
  training <- mutate(training,
                     cause = fct_relevel(cause,
                                         "lightning",
                                         "accident",
                                         "arson",
                                         "burning_off"))
  
  training <- na.omit(training)
  
  training <- select(training, -dist_road, -dist_cfa, -dist_camp, -FIRE_START)
  

  
library(sf)
library(rnaturalearth)
au_map <- ne_states(country = 'Australia', returnclass = 'sf')
vic_map <- au_map[7,]

lat <- seq(34, 39, 0.2)
lat <- -lat
lon <- seq(141, 150, 0.2)

grids <- expand.grid(lat, lon)


rect <- function(x){

  # left top
  lat1 <- x[1]
  lon1 <- x[2]

  # right top
  lat2 <- x[1]
  lon2 <- x[2]+0.2

  # right bottom
  lat3 <- x[1]-0.2
  lon3 <- x[2]+0.2

  # left bottom
  lat4 <- x[1]-0.2
  lon4 <- x[2]

  st_sfc(st_polygon(list(matrix(c(lon1,lat1,lon2,lat2,lon3,lat3,lon4,lat4,lon1,lat1), ncol =2, byrow = TRUE))))

}

rect_list <- apply(grids[1:nrow(grids),],1,rect)

rect_list <- do.call(c, rect_list)

st_crs(rect_list) <- 4326

indexes <- st_intersects(vic_map$geometry, rect_list)[[1]]
rect_list <- rect_list[indexes]

training2 <- st_as_sf(training, coords = c("lon", "lat"), crs = 4326)

indexes <- st_intersects(rect_list, training2)

training$rect <- 0
for (i in 1:length(indexes)){
  training$rect[indexes[[i]]] <- i
}

rect_list <- as.data.frame(rect_list)
rect_list <- mutate(rect_list, rect = 1:nrow(rect_list))

temp <- training %>%
  group_by(rect, year, month) %>%
  summarise(count = n()) %>%
  ungroup() %>%
  group_by(rect, month) %>%
  summarise(count = n())

rect_list <- temp %>%
  left_join(rect_list, by = c("rect"))

ggplot() +
  geom_sf(data = rect_list, aes(geometry = geometry, fill = count/19), col = NA) +
  facet_wrap(~fct_recode(month, "Oct" = "10", "Nov" = "11", "Dec" = "12", "Jan" = "1", "Feb" = "2", "Mar" = "3")) +
  theme_map() +
  theme(legend.position = "right") +
  scale_fill_distiller(palette = "Reds", direction = 1, limits = c(0,1), na.value = "grey") +
  labs(fill = "Frequency")

rect_list_st <- rect_list

```

```{r posterior, fig.cap="The joint probability of lightning-ignited bushfire occur, which could be a future extension."}
lat <- seq(34, 39, 0.2)
lat <- -lat
lon <- seq(141, 150, 0.2)

grids <- expand.grid(lat, lon)


rect <- function(x){

  # left top
  lat1 <- x[1]
  lon1 <- x[2]

  # right top
  lat2 <- x[1]
  lon2 <- x[2]+0.2

  # right bottom
  lat3 <- x[1]-0.2
  lon3 <- x[2]+0.2

  # left bottom
  lat4 <- x[1]-0.2
  lon4 <- x[2]

  st_sfc(st_polygon(list(matrix(c(lon1,lat1,lon2,lat2,lon3,lat3,lon4,lat4,lon1,lat1), ncol =2, byrow = TRUE))))

}

rect_list <- apply(grids[1:nrow(grids),],1,rect)

rect_list <- do.call(c, rect_list)

st_crs(rect_list) <- 4326

indexes <- st_intersects(vic_map$geometry, rect_list)[[1]]
rect_list <- rect_list[indexes]



sim <- read_csv("data/prediction_2019-2020_simulation.csv")

sim2 <- st_as_sf(sim, coords = c("lon", "lat"), crs = 4326)


rect_index <- st_intersects(rect_list, sim2)

sim$rect <- 0
for (i in 1:length(indexes)){
  sim$rect[rect_index[[i]]] <- i
}

rect_list <- as.data.frame(rect_list)
rect_list <- mutate(rect_list, rect = 1:nrow(rect_list))


temp <- sim %>%
  group_by(rect, month, cause) %>%
  summarise(count = n()) %>%
  ungroup() %>%
  spread(cause, count)

temp[is.na(temp)] <- 0
  
rect_list <- temp %>%
  right_join(rect_list, by = c("rect"))

rect_list <- rect_list %>%
  gather(key = "cause", value = "count", lightning, accident, arson, burning_off) %>%
  mutate(cause = factor(tools::toTitleCase(cause), levels = c("Lightning", "Accident", "Arson", "Burning_off")))


rect_list <- filter(rect_list, cause == "Lightning")
rect_list_st <- rename(rect_list_st, past_count = count)

rect_list_st <- mutate(rect_list_st, month = as.numeric(levels(month))[month])


rect_list <- left_join(rect_list, select(rect_list_st, -geometry), by = c("rect", "month"))


rect_list <- mutate(rect_list, poster = (count/10)*(past_count/19))

ggplot() +
  geom_sf(data = rect_list, aes(geometry = geometry, fill = poster), col = NA) +
  facet_wrap(~factor(month.abb[month], levels = c("Oct", "Nov", "Dec", "Jan", "Feb", "Mar"))) +
  theme_map() +
  theme(legend.position = "right") +
  scale_fill_distiller(palette = "Reds", direction = 1, limits = c(0,1)) +
  labs(fill = "Probability")
```




